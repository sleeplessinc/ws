<!doctype html>
<html>
<body>
Hi.
<div id=out></div>
<script>
	
	wrt = function(s) {
		var e = I("out")
		e.innerHTML = s+"<br>\n"+e.innerHTML
		console.log(s)
	} 

	msgs = function(m) {
		wrt("MSG: "+o2j(m))
		m.reply({nick:"Bob"})

	}

	ctrls = function(s, con) {
		if(s == "connect") {
			setTimeout(function() {
				con.send({msg:"sup?"}, function(r) {
					wrt("server said, "+o2j(r))
				})
			}, 1000)
		}
		wrt("CTRL: "+s)
	}

	setTimeout(function() {
		ws.dbg = log;
		ws.connect(msgs, ctrls)
	}, 1 * 1000)

</script>




